<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="/css/styles.css">
</head>

<body>
<h1>Minesweeper</h1>
<div class="center-div">
<% if (endgame==="LOSE") { %>
       <p>BOOM!.....YOU LOSE :(</p>
       <form action="/newgame" method="post" enctype="multipart/form-data">
              <label for="minepercentageid">Mine Percentage:</label>
              <input type="range" id="minepercentageid" name="minepercentagename" min="10" max="40" value="25" oninput="this.nextElementSibling.value=this.value">
              <output for="minepercentageid">25</output>%
              <br>
              <input type="submit" value="NEW GAME">
       </form>
       <br>
       <% for (let rr = 0; rr < rows; rr++) { %>
              <span>
       <%     for (let cc = 0; cc < cols; cc++) { %>
       <%          if (map_status[rr][cc]==="open") { %>
       <%               if (map[rr][cc]==="M") { %>
                             <input type="button" class="mine">
       <%               } else { %>
                             <input type="button" class="opened" value=<%= map[rr][cc] %>>
       <%               }  %>
       <%          } else if (map_status[rr][cc]==="closed") { %>
                        <input type="button" class="game_button" value="">
       <%          } else { %>
                        <input type="button" class="flagged" value="">
       <%          }  %>
       <%     }  %>
              </span>
              <br/>
       <% } %>
<% } else if (endgame==="WIN") { %>
       <p>YAY!.....YOU WIN :)</p>
       <form action="/newgame" method="post" enctype="multipart/form-data">
              <label for="minepercentageid">Mine Percentage:</label>
              <input type="range" id="minepercentageid" name="minepercentagename" min="10" max="40" value="25" oninput="this.nextElementSibling.value=this.value">
              <output for="minepercentageid">25</output>%
              <br>
              <input type="submit" value="NEW GAME">
       </form>
       <br>
       <% for (let rr = 0; rr < rows; rr++) { %>
              <span>
       <%     for (let cc = 0; cc < cols; cc++) { %>
       <%          if (map_status[rr][cc]==="open") { %>
       <%               if (map[rr][cc]==="M") { %>
                             <input type="button" class="mine">
       <%               } else { %>
                             <input type="button" class="opened" value=<%= map[rr][cc] %>>
       <%               }  %>
       <%          } else if (map_status[rr][cc]==="closed") { %>
                        <input type="button" class="game_button" value="">
       <%          } else { %>
                        <input type="button" class="flagged" value="">
       <%          }  %>
       <%     }  %>
              </span>
              <br/>
       <% } %>
<% } else { %>
       <form action="/game_click" method="post" enctype="multipart/form-data">
       <span>
<% if (clicktype==="Dig") { %>
       <input type="radio" name="click_type" value="Dig"  checked><img src="/css/icons8-minecraft-shovel-100.png" alt="Dig">
       <input type="radio" name="click_type" value="Flag"><img src='/css/icons8-flag-filled-96.png' alt="Flag">
<% } else { %>
       <input type="radio" name="click_type" value="Dig"><img src="/css/icons8-minecraft-shovel-100.png" alt="Dig">
       <input type="radio" name="click_type" value="Flag" checked><img src='/css/icons8-flag-filled-96.png' alt="Flag">
<% } %>
       </span>
       <br>
       <% for (let rr = 0; rr < rows; rr++) { %>
              <span>
       <%     for (let cc = 0; cc < cols; cc++) { %>
       <%          if (map_status[rr][cc]==="open") { %>
       <%               if (map[rr][cc]==="M") { %>
                             <input type="button" class="mine">
       <%               } else { %>
                             <input type="button" class="opened" value=<%= map[rr][cc] %>>
       <%               }  %>
       <%          } else if (map_status[rr][cc]==="closed") { %>
                        <input type="submit" name=button_<%= rr %>_<%= cc %>  class="game_button" value="">
       <%          } else { %>
                        <input type="submit" name=button_<%= rr %>_<%= cc %>  class="flagged" value="">
       <%          }  %>
       <%     }  %>
              </span>
              <br>
       <% } %>
       </form>
<% } %>
</div>
</body>
</html>

